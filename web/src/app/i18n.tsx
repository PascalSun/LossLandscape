/* Minimal client-side i18n (EN/ä¸­æ–‡) with a header language toggle. */
'use client';

import React, { createContext, useContext, useEffect, useMemo, useState } from 'react';

export type Locale = 'en' | 'zh';

const DICT = {
  en: {
    appName: 'LearnableKGE',
    tagline: 'Loss Landscape',
    navGenerate: 'Generate',
    navViewer: 'Viewer',
    panelGenerateTitle: 'Generate',
    inputSource: 'Input source',
    fromConfig: 'From Config',
    fromRun: 'From Run',
    configPath: 'Config path',
    runDir: 'Run directory',
    repoRelative: 'repo-relative',
    loadFromRunHint: 'Select a run directory to load landscape data from outputs/run_xxx/',
    noRunsFound: 'No runs found',
    loading: 'Loadingâ€¦',
    optional: 'optional',
    runHint: 'If run is set, config is ignored; config + trajectory are extracted from the run folder.',
    mode: 'Generation Mode',
    mode2D: '2D Grid',
    mode3D: '3D Volume',
    grid: 'Grid',
    direction: 'Direction',
    generate: 'Generate',
    generating: 'Generatingâ€¦',
    perfHint: 'Tip: 3D + grid=50 can be slow; try 30 first.',
    perfPresets: 'Quick Presets',
    presetFast: 'âš¡ Fast',
    presetStandard: 'ğŸ“Š Standard',
    presetHQ: 'ğŸ’ High Quality',
    maxBatches: 'Max Batches',
    viewerTitle: 'Viewer',
    noDataTitle: 'No data yet',
    noDataDesc: 'Select a run directory to load landscape data.',
    loadingOverlay: 'Generating loss landscapeâ€¦',
    historyTitle: 'History',
    historyHint: 'Load previously generated results (stored in DuckDB).',
    refresh: 'Refresh',
    load: 'Load',
    importTitle: 'Import',
    importHint: 'Import JSON files generated by loss landscape generation. Upload a file or scan a folder to automatically import all JSON files.',
    import: 'Import',
    uploadFile: 'Upload File',
    uploadHint: 'Upload a JSON file from your computer',
    selectFile: 'Select JSON file',
    fileSelected: 'File selected',
    scanFolder: 'Scan Folder',
    scanFolderHint: 'Scan a run directory (e.g., outputs/run_xxx) to automatically import all JSON files',
    folderPath: 'Folder path',
    scanAndImport: 'Scan & Import All',
    scanning: 'Scanningâ€¦',
    importing: 'Importingâ€¦',
    filesFound: 'files found',
    filesImported: 'files imported',
    viewMode: 'View Mode',
    view2D: '2D Heatmap',
    viewSurface: '2D',
    viewSurfaceSlice: '3D Surface (Î³ slice)',
    viewSlice: '3D',
    viewVolume: '3D',
    view3DRenderMode: '3D Render Mode',
    view3DSlice: 'Slice',
    view3DVolume: 'Volume Render',
    gamma: 'Î³',
    opacity: 'Opacity',
    step: 'Step',
    lowerIsBetter: 'Lower is better',
    view2DDesc: 'Shows loss in 2D (Î±, Î²). Good for understanding loss variations in two directions.',
    view3DSurfaceDesc: 'Shows loss as 3D surface (Î±, Î², loss). Good for seeing the overall shape.',
    view3DSurfaceSliceDesc: 'Pick a Î³ slice of the 3D volume and view it as a 3D surface. Use the slider to move through slices.',
    view3DSliceDesc: 'Shows 2D slices of 3D volume at different Î³ values. Reveals how loss changes along the third dimension.',
    view3DVolumeDesc: 'Shows all slices blended together. Reveals 3D structure and high-loss regions.',
    themeToggleDark: 'Switch to dark mode',
    themeToggleLight: 'Switch to light mode',
    deleteLandscape: 'Delete Landscape',
    deleteConfirm: 'Are you sure you want to delete this landscape? This action cannot be undone.',
    deleteFailed: 'Delete Failed',
    deleteFailedMessage: 'Failed to delete',
    previouslyGenerated: 'Previously generated landscapes',
    noHistoryFound: 'No history found',
    delete: 'Delete',
    runDirectory: 'Run Directory',
    file: 'File',
    imported: 'Imported',
    created: 'Created',
    uploadLandscapeHint: 'Upload a landscape JSON file. The file will be validated before import.',
    dropFileHere: 'Drop file here',
    dragDropFile: 'Drag & drop file here',
    orClickToBrowse: 'or click to browse',
    supportsJsonOnly: 'Supports .json files only',
    clickToChangeFile: 'Click to change file',
    size: 'Size',
    uploadingAndImporting: 'Uploading and importing...',
    uploadAndImport: 'Upload & Import',
    fileMustBeJson: 'File must be a .json file',
    pleaseSelectFile: 'Please select a file first',
    uploadFailed: 'Upload failed',
    fileUploadedSuccess: 'File uploaded and imported successfully!',
    loading3D: 'Loading 3D visualization...',
    loading2D: 'Loading 2D visualization...',
    loading1D: 'Loading 1D visualization...',
    loadingVolumeSlice: 'Loading volume slice...',
    loadingVolumeRender: 'Loading volume render...',
    loadingHessian: 'Loading Hessian analysis...',
    runMetadata: 'Run Metadata',
    comprehensiveInfo: 'Comprehensive information about this experiment',
    summary: 'Summary',
    overview: 'Overview',
    factorsAffectingLoss: 'Factors Directly Affecting Loss Landscape',
    emptyArray: 'empty array',
    arrayItems: 'Array',
    hessianAnalysis: 'Hessian Analysis',
    hessianStaticDesc: 'Static analysis of the loss landscape curvature at the current checkpoint.',
    hessianEvolutionDesc: 'Evolution of loss landscape curvature throughout training, analyzing the Hessian spectrum.',
    spectralMonitor: 'Spectral Monitor',
    spectralMonitorHint: 'Epoch {epoch} Â· Î»max / Trace Â· slide to explore spectrum history',
    curvatureDynamics: 'Curvature Dynamics',
    lambdaMaxSharpness: 'Î»max (Sharpness): Largest eigenvalue of the Hessian, tracking the sharpest direction in the loss landscape.',
    stabilityBoundary: 'Stability Boundary (2/Î·): If Î»max exceeds this, training may become unstable for plain SGD.',
    traceDesc: 'Trace: Sum of eigenvalues, representing total curvature around the current point.',
    sharpness: 'Sharpness (Î»max)',
    stability: 'Stability (2/Î·)',
    totalCurvature: 'Total Curvature (Trace)',
    spectralAnalysis: 'Spectral Analysis',
    spectralDensityDesc: 'Spectral Density: KDE of Hessian eigenvalues; the current epoch is highlighted.',
    screePlotDesc: 'Scree Plot: Top eigenvalues (algebraic order) to separate bulk spectrum from outliers.',
    spectralDensity: 'Spectral Density (KDE)',
    epoch: 'Epoch',
    history: 'History',
    noDensityData: 'No density data available',
    topKSpectrum: 'Top-k Spectrum (Ranked)',
    rank: 'Rank',
    eigenvalue: 'Eigenvalue',
    noSpectrumData: 'No spectrum data available',
    density: 'Density',
    currentPosition: 'Current Position',
    trainingTrajectory: 'Training Trajectory',
    baselineLoss: 'Baseline Loss',
    highLoss: 'High Loss',
    lowLoss: 'Low Loss',
    scale: 'Scale',
    log: 'Log',
    linear: 'Linear',
    tipHover: 'Tip: Move mouse over the plot to see exact values',
    tip3D: 'Tip: Drag to rotate, scroll to zoom, hover to see values',
    hoverForHint: 'Hover for hint',
    lossLandscape2D: 'Loss Landscape (2D)',
    lossLandscape3D: 'Loss Landscape (3D)',
    lowerIsBetterArrow: 'â†“ Lower is better â†“',
    noData: 'No Data',
    tabRun: 'Run',
    tabHistory: 'History',
    tabUpload: 'Upload',
    loss: 'Loss',
    trainLoss: 'Train Loss',
    validationLoss: 'Validation Loss',
    alpha: 'Î±',
    beta: 'Î²',
    log10Loss: 'logâ‚â‚€(loss)',
    sectionExperiment: 'Experiment',
    sectionDataset: 'Dataset',
    sectionModel: 'Model',
    sectionTraining: 'Training',
    sectionTrainingStatistics: 'Training Statistics',
    sectionLossFunction: 'Loss Function',
    sectionLandscapeGeneration: 'Landscape Generation',
    sectionSystemInformation: 'System Information',
    alphaCurve: 'Alpha curve',
    alphaFloor: 'Alpha floor',
    metrics: 'Metrics',
    trainingProgression: 'Training progression',
    noHessianMetrics: 'This run does not have Hessian metrics.',
    noHessianDataAvailable: 'No Hessian Data Available',
    view1D: '1D',
    view1DDesc: '1D Loss Landscape visualization',
    viewHessian: 'Hessian',
    viewHessianSnapshot: 'Hessian snapshot (no trajectory)',
    viewHessianMetrics: 'Hessian metrics over training (Î»max, Trace, Spectrum)',
    viewMetadata: 'Metadata',
    viewMetadataDesc: 'View comprehensive run metadata',
    slices: 'slices',
    volumeRenderingDesc: 'Volume rendering: all slices blended together. Brighter = higher loss. Rotate to see 3D structure.',
    landscapeLoss: 'Landscape Loss',
    valueLabelTrain: 'train',
    valueLabelVal: 'val',
    valueLabelLand: 'land',
    no1DLossData: 'This run does not have 1D loss landscape data.',
    items: 'items',
    modalOK: 'OK',
    modalCancel: 'Cancel',
    noMetadataAvailable: 'No Metadata Available',
    noMetadataInfo: 'This run does not have metadata information.',
    no1DDataAvailable: 'No 1D Data Available',
    notAvailable: 'N/A',
    sliceIndex: 'Slice Index',
    alphaSlice: 'Î±-slice',
    betaSlice: 'Î²-slice',
    gammaSlice: 'Î³-slice',
    alphaIdx: 'Î± idx',
    betaIdx: 'Î² idx',
    gammaIdx: 'Î³ idx',
    axis: 'Axis',
    threshold: 'Threshold',
    dataMinMax: 'Data min/max:',
  },
  zh: {
    appName: 'LearnableKGE',
    tagline: 'Loss Landscape',
    navGenerate: 'ç”Ÿæˆ',
    navViewer: 'é¢„è§ˆ',
    panelGenerateTitle: 'ç”Ÿæˆ',
    inputSource: 'è¾“å…¥æ¥æº',
    fromConfig: 'ä» Config',
    fromRun: 'ä» Run',
    configPath: 'Config è·¯å¾„',
    runDir: 'Run ç›®å½•',
    repoRelative: 'ç›¸å¯¹ä»“åº“è·¯å¾„',
    loadFromRunHint: 'é€‰æ‹©ä¸€ä¸ª run ç›®å½•ï¼Œä» outputs/run_xxx/ åŠ è½½ landscape æ•°æ®',
    noRunsFound: 'æœªæ‰¾åˆ° run',
    loading: 'åŠ è½½ä¸­â€¦',
    optional: 'å¯é€‰',
    runHint: 'å¦‚æœå¡«å†™ runï¼Œä¼šå¿½ç•¥ configï¼Œå¹¶ä» run ç›®å½•è‡ªåŠ¨æå– config + trajectoryã€‚',
    mode: 'ç”Ÿæˆæ¨¡å¼',
    mode2D: '2D ç½‘æ ¼',
    mode3D: '3D ä½“ç§¯',
    grid: 'ç½‘æ ¼',
    direction: 'æ–¹å‘',
    generate: 'ç”Ÿæˆ',
    generating: 'ç”Ÿæˆä¸­â€¦',
    perfHint: 'æç¤ºï¼š3D + grid=50 ä¼šæ¯”è¾ƒæ…¢ï¼Œå»ºè®®å…ˆç”¨ 30ã€‚',
    perfPresets: 'å¿«é€Ÿé¢„è®¾',
    presetFast: 'âš¡ å¿«é€Ÿ',
    presetStandard: 'ğŸ“Š æ ‡å‡†',
    presetHQ: 'ğŸ’ é«˜è´¨é‡',
    maxBatches: 'æœ€å¤§æ‰¹æ¬¡',
    viewerTitle: 'é¢„è§ˆ',
    noDataTitle: 'æš‚æ— æ•°æ®',
    noDataDesc: 'é€‰æ‹©ä¸€ä¸ª run ç›®å½•ä»¥åŠ è½½ landscape æ•°æ®ã€‚',
    loadingOverlay: 'æ­£åœ¨ç”Ÿæˆ loss landscapeâ€¦',
    historyTitle: 'å†å²è®°å½•',
    historyHint: 'åŠ è½½å·²ç”Ÿæˆç»“æœï¼ˆå­˜å‚¨åœ¨ DuckDBï¼‰ã€‚',
    refresh: 'åˆ·æ–°',
    load: 'è½½å…¥',
    importTitle: 'å¯¼å…¥',
    importHint: 'å¯¼å…¥ loss landscape ç”Ÿæˆäº§ç”Ÿçš„ JSON æ–‡ä»¶ã€‚å¯ä»¥ä¸Šä¼ å•ä¸ªæ–‡ä»¶æˆ–æ‰«ææ–‡ä»¶å¤¹è‡ªåŠ¨å¯¼å…¥æ‰€æœ‰ JSON æ–‡ä»¶ã€‚',
    import: 'å¯¼å…¥',
    uploadFile: 'ä¸Šä¼ æ–‡ä»¶',
    uploadHint: 'ä»æ‚¨çš„ç”µè„‘ä¸Šä¼  JSON æ–‡ä»¶',
    selectFile: 'é€‰æ‹© JSON æ–‡ä»¶',
    fileSelected: 'å·²é€‰æ‹©æ–‡ä»¶',
    scanFolder: 'æ‰«ææ–‡ä»¶å¤¹',
    scanFolderHint: 'æ‰«æ run ç›®å½•ï¼ˆå¦‚ outputs/run_xxxï¼‰è‡ªåŠ¨å¯¼å…¥æ‰€æœ‰ JSON æ–‡ä»¶',
    folderPath: 'æ–‡ä»¶å¤¹è·¯å¾„',
    scanAndImport: 'æ‰«æå¹¶å¯¼å…¥å…¨éƒ¨',
    scanning: 'æ‰«æä¸­â€¦',
    importing: 'å¯¼å…¥ä¸­â€¦',
    filesFound: 'ä¸ªæ–‡ä»¶',
    filesImported: 'ä¸ªæ–‡ä»¶å·²å¯¼å…¥',
    viewMode: 'è§†å›¾æ¨¡å¼',
    view2D: '2D çƒ­å›¾',
    viewSurface: '2D',
    viewSurfaceSlice: '3D æ›²é¢(Î³åˆ‡ç‰‡)',
    viewSlice: '3D',
    viewVolume: '3D',
    view3DRenderMode: '3D æ¸²æŸ“æ–¹å¼',
    view3DSlice: 'åˆ‡ç‰‡',
    view3DVolume: 'ä½“æ¸²æŸ“',
    gamma: 'Î³',
    opacity: 'é€æ˜åº¦',
    step: 'æ­¥é•¿',
    lowerIsBetter: 'è¶Šä½è¶Šå¥½',
    view2DDesc: 'æ˜¾ç¤º2D loss landscape (Î±, Î²)ã€‚é€‚åˆç†è§£ä¸¤ä¸ªæ–¹å‘ä¸Šçš„losså˜åŒ–ã€‚',
    view3DSurfaceDesc: 'æ˜¾ç¤º3D loss æ›²é¢ (Î±, Î², loss)ï¼Œä¾¿äºæ•´ä½“è§‚å¯Ÿå½¢çŠ¶ã€‚',
    view3DSurfaceSliceDesc: 'å¯¹3Dä½“ç§¯æŒ‰Î³å–åˆ‡ç‰‡ï¼Œç”¨3Dæ›²é¢å±•ç¤ºã€‚æ‹–åŠ¨æ»‘æ¡åœ¨ä¸åŒåˆ‡ç‰‡é—´åˆ‡æ¢ã€‚',
    view3DSliceDesc: 'æ˜¾ç¤º3Dä½“ç§¯åœ¨ä¸åŒÎ³å€¼ä¸‹çš„2Dåˆ‡ç‰‡ã€‚æ­ç¤ºlossåœ¨ç¬¬ä¸‰ä¸ªç»´åº¦ä¸Šçš„å˜åŒ–ã€‚',
    view3DVolumeDesc: 'æ˜¾ç¤ºæ‰€æœ‰åˆ‡ç‰‡æ··åˆå åŠ ã€‚æ­ç¤º3Dç»“æ„å’Œé«˜lossåŒºåŸŸã€‚',
    themeToggleDark: 'åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼',
    themeToggleLight: 'åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼',
    deleteLandscape: 'åˆ é™¤ Landscape',
    deleteConfirm: 'æ‚¨ç¡®å®šè¦åˆ é™¤è¿™ä¸ª landscape å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚',
    deleteFailed: 'åˆ é™¤å¤±è´¥',
    deleteFailedMessage: 'åˆ é™¤å¤±è´¥',
    previouslyGenerated: 'ä¹‹å‰ç”Ÿæˆçš„ landscapes',
    noHistoryFound: 'æœªæ‰¾åˆ°å†å²è®°å½•',
    delete: 'åˆ é™¤',
    runDirectory: 'Run ç›®å½•',
    file: 'æ–‡ä»¶',
    imported: 'å·²å¯¼å…¥',
    created: 'å·²åˆ›å»º',
    uploadLandscapeHint: 'ä¸Šä¼ ä¸€ä¸ª landscape JSON æ–‡ä»¶ã€‚æ–‡ä»¶å°†åœ¨å¯¼å…¥å‰è¿›è¡ŒéªŒè¯ã€‚',
    dropFileHere: 'å°†æ–‡ä»¶æ‹–æ”¾åˆ°æ­¤å¤„',
    dragDropFile: 'æ‹–æ”¾æ–‡ä»¶åˆ°æ­¤å¤„',
    orClickToBrowse: 'æˆ–ç‚¹å‡»æµè§ˆ',
    supportsJsonOnly: 'ä»…æ”¯æŒ .json æ–‡ä»¶',
    clickToChangeFile: 'ç‚¹å‡»æ›´æ”¹æ–‡ä»¶',
    size: 'å¤§å°',
    uploadingAndImporting: 'æ­£åœ¨ä¸Šä¼ å¹¶å¯¼å…¥...',
    uploadAndImport: 'ä¸Šä¼ å¹¶å¯¼å…¥',
    fileMustBeJson: 'æ–‡ä»¶å¿…é¡»æ˜¯ .json æ–‡ä»¶',
    pleaseSelectFile: 'è¯·å…ˆé€‰æ‹©æ–‡ä»¶',
    uploadFailed: 'ä¸Šä¼ å¤±è´¥',
    fileUploadedSuccess: 'æ–‡ä»¶å·²æˆåŠŸä¸Šä¼ å¹¶å¯¼å…¥ï¼',
    loading3D: 'æ­£åœ¨åŠ è½½ 3D å¯è§†åŒ–...',
    loading2D: 'æ­£åœ¨åŠ è½½ 2D å¯è§†åŒ–...',
    loading1D: 'æ­£åœ¨åŠ è½½ 1D å¯è§†åŒ–...',
    loadingVolumeSlice: 'æ­£åœ¨åŠ è½½ä½“ç§¯åˆ‡ç‰‡...',
    loadingVolumeRender: 'æ­£åœ¨åŠ è½½ä½“ç§¯æ¸²æŸ“...',
    loadingHessian: 'æ­£åœ¨åŠ è½½ Hessian åˆ†æ...',
    runMetadata: 'Run å…ƒæ•°æ®',
    comprehensiveInfo: 'å…³äºæ­¤å®éªŒçš„å…¨é¢ä¿¡æ¯',
    summary: 'æ‘˜è¦',
    overview: 'æ¦‚è§ˆ',
    factorsAffectingLoss: 'ç›´æ¥å½±å“ Loss Landscape çš„å› ç´ ',
    emptyArray: 'ç©ºæ•°ç»„',
    arrayItems: 'æ•°ç»„',
    hessianAnalysis: 'Hessian åˆ†æ',
    hessianStaticDesc: 'å½“å‰æ£€æŸ¥ç‚¹çš„æŸå¤±æ™¯è§‚æ›²ç‡é™æ€åˆ†æã€‚',
    hessianEvolutionDesc: 'è®­ç»ƒè¿‡ç¨‹ä¸­æŸå¤±æ™¯è§‚æ›²ç‡çš„æ¼”å˜ï¼Œåˆ†æ Hessian è°±ã€‚',
    spectralMonitor: 'è°±ç›‘æ§å™¨',
    spectralMonitorHint: 'Epoch {epoch} Â· Î»max / Trace Â· æ»‘åŠ¨ä»¥æ¢ç´¢è°±å†å²',
    curvatureDynamics: 'æ›²ç‡åŠ¨åŠ›å­¦',
    lambdaMaxSharpness: 'Î»max (é”åº¦): Hessian çš„æœ€å¤§ç‰¹å¾å€¼ï¼Œè¿½è¸ªæŸå¤±æ™¯è§‚ä¸­æœ€å°–é”çš„æ–¹å‘ã€‚',
    stabilityBoundary: 'ç¨³å®šæ€§è¾¹ç•Œ (2/Î·): å¦‚æœ Î»max è¶…è¿‡æ­¤å€¼ï¼Œæ™®é€š SGD çš„è®­ç»ƒå¯èƒ½å˜å¾—ä¸ç¨³å®šã€‚',
    traceDesc: 'Trace: ç‰¹å¾å€¼ä¹‹å’Œï¼Œè¡¨ç¤ºå½“å‰ç‚¹å‘¨å›´çš„æ€»æ›²ç‡ã€‚',
    sharpness: 'é”åº¦ (Î»max)',
    stability: 'ç¨³å®šæ€§ (2/Î·)',
    totalCurvature: 'æ€»æ›²ç‡ (Trace)',
    spectralAnalysis: 'è°±åˆ†æ',
    spectralDensityDesc: 'è°±å¯†åº¦: Hessian ç‰¹å¾å€¼çš„ KDEï¼›å½“å‰ epoch è¢«é«˜äº®æ˜¾ç¤ºã€‚',
    screePlotDesc: 'ç¢çŸ³å›¾: é¡¶éƒ¨ç‰¹å¾å€¼ï¼ˆä»£æ•°é¡ºåºï¼‰ä»¥åŒºåˆ†ä¸»ä½“è°±å’Œå¼‚å¸¸å€¼ã€‚',
    spectralDensity: 'è°±å¯†åº¦ (KDE)',
    epoch: 'Epoch',
    history: 'å†å²',
    noDensityData: 'æ— å¯†åº¦æ•°æ®å¯ç”¨',
    topKSpectrum: 'Top-k è°±ï¼ˆå·²æ’åºï¼‰',
    rank: 'æ’å',
    eigenvalue: 'ç‰¹å¾å€¼',
    noSpectrumData: 'æ— è°±æ•°æ®å¯ç”¨',
    density: 'å¯†åº¦',
    currentPosition: 'å½“å‰ä½ç½®',
    trainingTrajectory: 'è®­ç»ƒè½¨è¿¹',
    baselineLoss: 'åŸºçº¿ Loss',
    highLoss: 'é«˜ Loss',
    lowLoss: 'ä½ Loss',
    scale: 'æ¯”ä¾‹',
    log: 'å¯¹æ•°',
    linear: 'çº¿æ€§',
    tipHover: 'æç¤º: å°†é¼ æ ‡æ‚¬åœåœ¨å›¾è¡¨ä¸Šä»¥æŸ¥çœ‹ç²¾ç¡®å€¼',
    tip3D: 'æç¤º: æ‹–åŠ¨æ—‹è½¬ï¼Œæ»šåŠ¨ç¼©æ”¾ï¼Œæ‚¬åœæŸ¥çœ‹å€¼',
    hoverForHint: 'æ‚¬åœæŸ¥çœ‹æç¤º',
    lossLandscape2D: 'Loss Landscape (2D)',
    lossLandscape3D: 'Loss Landscape (3D)',
    lowerIsBetterArrow: 'â†“ è¶Šä½è¶Šå¥½ â†“',
    noData: 'æ— æ•°æ®',
    tabRun: 'è¿è¡Œ',
    tabHistory: 'å†å²',
    tabUpload: 'ä¸Šä¼ ',
    loss: 'æŸå¤±',
    trainLoss: 'è®­ç»ƒæŸå¤±',
    validationLoss: 'éªŒè¯æŸå¤±',
    alpha: 'Î±',
    beta: 'Î²',
    log10Loss: 'logâ‚â‚€(æŸå¤±)',
    sectionExperiment: 'å®éªŒ',
    sectionDataset: 'æ•°æ®é›†',
    sectionModel: 'æ¨¡å‹',
    sectionTraining: 'è®­ç»ƒ',
    sectionTrainingStatistics: 'è®­ç»ƒç»Ÿè®¡',
    sectionLossFunction: 'æŸå¤±å‡½æ•°',
    sectionLandscapeGeneration: 'Landscape ç”Ÿæˆ',
    sectionSystemInformation: 'ç³»ç»Ÿä¿¡æ¯',
    alphaCurve: 'Alpha æ›²çº¿',
    alphaFloor: 'Alpha åº•é™',
    metrics: 'æŒ‡æ ‡',
    trainingProgression: 'è®­ç»ƒè¿›åº¦',
    noHessianMetrics: 'æ­¤è¿è¡Œæ²¡æœ‰ Hessian æŒ‡æ ‡ã€‚',
    noHessianDataAvailable: 'æ—  Hessian æ•°æ®å¯ç”¨',
    view1D: '1D',
    view1DDesc: '1D Loss Landscape å¯è§†åŒ–',
    viewHessian: 'Hessian',
    viewHessianSnapshot: 'Hessian å¿«ç…§ï¼ˆæ— è½¨è¿¹ï¼‰',
    viewHessianMetrics: 'è®­ç»ƒè¿‡ç¨‹ä¸­çš„ Hessian æŒ‡æ ‡ (Î»max, Trace, Spectrum)',
    viewMetadata: 'å…ƒæ•°æ®',
    viewMetadataDesc: 'æŸ¥çœ‹å®Œæ•´çš„è¿è¡Œå…ƒæ•°æ®',
    slices: 'åˆ‡ç‰‡',
    volumeRenderingDesc: 'ä½“ç§¯æ¸²æŸ“ï¼šæ‰€æœ‰åˆ‡ç‰‡æ··åˆåœ¨ä¸€èµ·ã€‚è¶Šäº® = æŸå¤±è¶Šé«˜ã€‚æ—‹è½¬æŸ¥çœ‹ 3D ç»“æ„ã€‚',
    landscapeLoss: 'Landscape æŸå¤±',
    valueLabelTrain: 'è®­ç»ƒ',
    valueLabelVal: 'éªŒè¯',
    valueLabelLand: 'Landscape',
    no1DLossData: 'æ­¤è¿è¡Œæ²¡æœ‰ 1D loss landscape æ•°æ®ã€‚',
    items: 'é¡¹',
    modalOK: 'ç¡®å®š',
    modalCancel: 'å–æ¶ˆ',
    noMetadataAvailable: 'æ— å…ƒæ•°æ®å¯ç”¨',
    noMetadataInfo: 'æ­¤è¿è¡Œæ²¡æœ‰å…ƒæ•°æ®ä¿¡æ¯ã€‚',
    no1DDataAvailable: 'æ—  1D æ•°æ®å¯ç”¨',
    notAvailable: 'ä¸å¯ç”¨',
    sliceIndex: 'åˆ‡ç‰‡ç´¢å¼•',
    alphaSlice: 'Î±-åˆ‡ç‰‡',
    betaSlice: 'Î²-åˆ‡ç‰‡',
    gammaSlice: 'Î³-åˆ‡ç‰‡',
    alphaIdx: 'Î± ç´¢å¼•',
    betaIdx: 'Î² ç´¢å¼•',
    gammaIdx: 'Î³ ç´¢å¼•',
    axis: 'è½´',
    threshold: 'é˜ˆå€¼',
    dataMinMax: 'æ•°æ®æœ€å°/æœ€å¤§å€¼:',
  },
} as const satisfies Record<Locale, Record<string, string>>;

type DictKey = keyof typeof DICT.en;
type Dict = Record<DictKey, string>;

const I18nCtx = createContext<{
  locale: Locale;
  setLocale: (l: Locale) => void;
  t: Dict;
} | null>(null);

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [locale, setLocale] = useState<Locale>(() => {
    if (typeof window !== 'undefined') {
      const saved = window.localStorage.getItem('locale');
      if (saved === 'en' || saved === 'zh') return saved;
    }
    return 'zh';
  });

  useEffect(() => {
    if (typeof window !== 'undefined') window.localStorage.setItem('locale', locale);
  }, [locale]);

  const value = useMemo(() => ({ locale, setLocale, t: DICT[locale] }), [locale]);
  return <I18nCtx.Provider value={value}>{children}</I18nCtx.Provider>;
}

export function useI18n() {
  const ctx = useContext(I18nCtx);
  if (!ctx) throw new Error('useI18n must be used within I18nProvider');
  return ctx;
}


